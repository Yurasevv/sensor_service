# Sensor service

Система состоит из двух частей: RESTful API сервиса для фильтрации и сортировки данных о погоде (далее “сервер”), а также как минимум одного сервиса, предоставляющим данные о погоде (далее “сенсор”). 

Сенсор представляет из себя приложение, которое может зарегистрировать себя на сервере. Далее через определенные промежутки времени, сенсор сообщает данные о погоде серверу. 

Сервер принимает данные от сенсора и сохраняет их в БД. Клиент может получать данные с сервера о имеющихся сенсорах и измерениях погоды.

## Сенсор
Реализованные запросы:

1. Перед началом работы сенсор обязан зарегистрироваться на сервере

POST {server.ip}/sensors/registration { "name": "Sensor name" }

2. Во время работы сенсор шлет данные о погоде на сервер раз в 3 - 15 секунд.

POST {server.ip}/sensors/{key}/measurements { “value”: 24.5, “raining”: false }

## Сервер

1.	Запрос на получение всех активных сенсоров. 

GET {server.ip}/sensors 
2. Запрос на получение информации о 20 последних измерениях сенсора. 

GET {server.ip}/sensors/{key}/measurements 
3.	Запрос на получение актуальной информации от всех сенсоров. Актуальными считаются те измерения, время которых не отличается от времени запроса более чем на одну минуту. 

GET {server.ip}/sensors/measurements

## Swagger

Swagger доступен по адресу http://localhost:8080/swagger-ui/index.html

## Тесты

Для тестов использовался JUnit и Mockito. Тестами покрыты контроллеры и сервисы

## Запуск

Миграции базы данных находятся в src/main/resources/db/migration

Три образа для сенсора, сервера и базы данных собираются через docker-compose.yml

### Сборка Maven

Для каждого модуля нужно получить target

```mvn clean install```

### Сборка Docker

```docker-compose up --build```

## Стэк
- Java
- Spring Boot, Data, Web
- Postgresql
- Hibernate, hibernate validator
- Flyway
- Docker
- Lombok
